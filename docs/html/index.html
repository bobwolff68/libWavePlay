<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WavePlay: Support classes for (limited) processing of WAVE/PCM files on an ESP32 device.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">WavePlay
   </div>
   <div id="projectbrief">Support classes for real-time processing and playout of WAV/PCM files on ESP32</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Support classes for (limited) processing of WAVE/PCM files on an ESP32 device. </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>There are a few wave file processing and DAC-output libraries available for ESP32, but none of them were structured in a nice C++ oriented manner or multi-threaded manner as would be desired, so I wrote my own. Please see the README.md file as well.</p>
<p>Want to play audio on your ESP32? You can hook up an I2S device but it'll cost quite a bit more than simply having an audio amplifier on the DAC pin. I've used the LM386 pre-built boards which are quite inexpensive. It is also possible to simply hook up a 4Ohm or 8Ohm speaker to the output of the DAC pin (25 or 26) but the volume will be very low even with the volume set to 100. I've found the LM386 at 5 volts works quite well for a nearby single speaker. When using 12 volts with the amplifier, I found too much clipping despite a generally louder final output.</p>
<h1><a class="anchor" id="limitations_sec"></a>
Limitations</h1>
<p>The WAVE specification allows for many features and options which have grown over the years since it was published in the 1990's. This library specifically concentrates on the use of non-compressed PCM formats. And while it is intended to support a variety of sampling rates, channels, and resolutions, it has been primarily tested against 8-bit resolution mono files. Ultimately it is possible to support much more, but the reality is that these little ESP32 devices have limited space to hold large files and often times the speaker output is limited enough to make high resolution or sampling rates ineffective in the real world.</p>
<p>So, watch out for pitfalls:</p><ul>
<li>Volume features are very specific to 8-bit values today. The pDataTable calculation is hard coded to 256 values. Supporting 16-bit values would require 32k*16-bit = 64kBytes of calculations. This could be limited to a smaller figure or samples could be volume-corrected on the fly for non-8-bit values as an alternative.</li>
<li>Another option with 16-bit files is to convert them to 8-bit on the fly, but this suffers from the fact that the file is large in memory/flash and yet there's no audio clarity gained by that higher resolution file. So, typically a utility like Audacity or ffmpeg is used to convert files down to 8-bits prior to loading them into the SPIFFS or LittleFS filesystem.</li>
<li>No multi-channel downmixing yet.</li>
<li>Since this is targeting an ESP32, there is an expectation that only a single instance is used. There are some static items in the classes which would be problematic for use if more than one instance is created. An advancement would be to use a factory or singleton pattern in such a case, but the added complication doesn't seem to make sense given the target. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
